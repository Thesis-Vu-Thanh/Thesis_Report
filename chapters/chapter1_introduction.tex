\chapter{Introduction}
\label{chap:introduction} 
	\textit{\hspace{0.5cm}In this chapter, we introduce issues in the field of cyber security and clarify the necessity of building a firewall system. Next, we present an overview of the goals, challenges, and structure of the thesis.}
\minitoc

\section{Motivation and problem statement}
\label{sec:motivation}
\hspace{0.5cm}Websites have become necessary for every business, brand, institution, organization, and individual. Web-based applications offer the general public and enterprises fast and simple services, they may be used for social media, email, banking, online shopping, education, or entertainment. Web applications are popular for a variety of reasons\footnote{Amy Bros. Sysprobs. \textit{Why are Web Applications Becoming Popular?}. July 2022. \url{https://www.sysprobs.com/web-applications-becoming-popular}}. For starters, web-based applications are convenient for users because they can be accessed from any location that has an internet connection. Second, a web application is a low-cost method for corporations because it does not require any special hardware or software and can be easily scaled up or down as needed. Furthermore, web-based apps frequently offer subscription-based models, which can be more cost-effective for businesses in the long run. Third, because web apps do not need to be downloaded or installed on a device, they are generally faster and more responsive than native apps. These are instead run on remote servers and accessed through a web browser. As a result, web apps can fully utilize the most recent advances in server-side technology, which helps in performance and speed. 

Why would someone want to attack web applications? Web applications are an attractive target for remote attackers because they can access the web app anywhere with an internet connection. Besides, they frequently handle sensitive information, such as login credentials and financial data. In short, web applications are targeted because they are visible, accessible, and offer a multitude of potential payoffs for an attacker. Cybercriminals can attack web applications for many reasons, including system flaws caused by incorrect coding, misconfigured web servers, application design flaws, or failure to validate forms. These flaws and vulnerabilities enable attackers to gain access to databases containing sensitive information. 


The action conducted by attackers, which can do harm to the web application can be called cyberattacks. Cyberattacks are malicious attempts to access a person's or an organization's computer systems, networks, or data without authorization. The vulnerability to cyberattacks and our reliance on technology and connectivity are growing in tandem. Unlike viruses that would shut down a system for a few hours a few years ago, the consequences of cyberattacks today can include stolen data, destroyed networks, and thousands, if not millions, of dollars in recovery efforts. Cyberattacks can harm businesses, governments, and society\footnote{CEI-The Digital Office. \textit{The Consequences Of Cyber Attacks And Their Impact On Cybersecurity}. \url{https://www.copycei.com/consequences-of-cyber-attacks}}. Among them, businesses and companies are more prone to being attacked by cybercriminals because they have more holes and gaps in their security that make them vulnerable to attacks. Cyberattacks affect a company's productivity, revenue, and reputation. Regarding productivity, nearly every business that suffers a cyberattack must suspend part or all of its operations until the attack is resolved, whether by paying a ransom, removing the malware from the device, network, or system, or restoring a backed-up version of its system. In terms of revenue, the costs of a cyberattack can wreck the economy of a company. The average cost of a data breach for a small to medium-sized business is massive, whether it has to shut down operations for several days, pay a ransom, lose data, replace devices, or pay a security expert to clean all malware out of the system or network. The most serious effect of a cyberattack is the loss of reputation. The most critical consequence of a cyberattack on a business is a loss of reputation. Consider the recent data breaches at Equifax, Target, and J.P. Morgan Chase, which led to the loss of customer data such as social security numbers, account details, and credit card numbers. Despite having the resources to recover, most businesses can not recover from security breaches because they lose their clients' trust and thus business. The biggest concern of a cyberattack on a government entity is the enormous volume of stolen data. This data could include everything from military and national security information to private data about civilians, which could be sold on the dark web and misused by terrorist groups. When cyberattacks happen, they badly affect practically every part of society, whether it's a large corporation or a small business. Consumers pay the price when enterprises, companies, and even nonprofit service providers like hospitals are forced to cover the costs of a cyberattack. There will be shortages that the customer will have to suffer when a company is restricted from providing its service as a result of cyberattacks or data breaches.

Let's take a look at Parachute's statistics\footnote{Parachute. 
\textit{Cyber Attack Statistics to Know in 2023}. \url{https://parachute.cloud/cyber-attack-statistics-data-and-trends/}}. 
Healthcare, throughout the past 12 years, this sector has experienced the most costly data breaches, the costs have even increased by 41.6\% from 2020 until 2022. At least 849 healthcare cybersecurity incidents and 571 data breaches were reported in 2022. The average financial loss due to data breaches in healthcare has skyrocketed from around USD 9 million to USD 10.10 million (2022). In the Finance industry, phishing attacks against banks and other financial institutions held the largest share, accounting for 23.2\% of all cyberattacks targeting the financial sector. In the first quarter of 2022, ransomware assaults increased by 35\% in the financial sectors. On average, financial organizations bore the second-highest data breach costs, at USD 5.97 million, just behind healthcare institutions (2022). 

From the above situation, we can see that tools like Web Application Firewalls play a crucial role in organizations' security systems. They are a powerful tool for preventing malicious traffic from entering or leaving an organization's systems. However, they also have some limitations\footnote{Sourcedefense. \textit{Limitations of WAFs}. \url{https://sourcedefense.com/glossary/limitations-of-waf/}}. The first drawback is false positives, a WAF may block legitimate traffic or requests if it mistakes them for malicious activity. Second, a WAF only protects against web-based attacks and may not be effective against other types of attacks. Next, a WAF can add overhead to the application and may affect its performance, which can be a concern for critical applications with high traffic volumes or strict performance requirements. We've found some studies about using machine learning to improve WAF, or building a machine learning-based WAF. Most of them have very positive results. The necessity of WAF in modern days and these studies have inspired us, therefore in this thesis, our group wants to make some efforts to strengthen WAFs' cyber security, and we decided to choose this topic - Building a Machine Learning-Based Web Application Firewall. This thesis will compare the existing methods of applying machine learning to WAF and build a WAF with machine learning based on the more effective approach.
\newpage
\section{Scope and objectives}
\label{sec:objectives}
\hspace{0.5cm}In this thesis, we will investigate recent studies about WAF, then divide them into main approaches according to the method used in the research. We will try to compare and analyze the main directions of machine learning in WAF. Based on the experiments with minimal models, false positive rate, and processing form of model size, we will try to prove which approach is more effective.

Cybersecurity needs to be enhanced because of the potential repercussions that cybercriminals could have. We aim to improve the capabilities of web application firewalls given the current need for cybersecurity. So, we decide to build a machine learning-based web application firewall. This thesis will focus on recognizing malicious requests that get past the firewall. We want to use machine learning\index{Machine learning (ML)} to create a WAF processing a massive volume of requests per second quickly and effectively. The created module ought to be able to validate the request and determine whether it's an attack or not.

We also aim to eliminate the high false positive\index{False positive} (FP) rate, an inherent weakness of rule-based\index{Rule-based} WAF\index{WAF}, and assure the speed of the WAF, which must react nearly instantly to deliver a consistent customer experience, the module will use two fast and simple machine learning models. Each model will run independently to generate an output, then combined the result to achieve an accuracy\index{Accuracy} of at least 95\% as well as low latency of 5 milliseconds\footnote{Abdalslam. \textit{Web Application Firewalls (WAF) Statistics, Trends And Facts 2023}. 
\url{https://abdalslam.com/web-application-firewalls-waf-statistics}} for the WAF.

\section{Challenges and solutions}
\label{sec:challenges_and_solutions}
\hspace{0.5cm}During this thesis, we have encountered challenge with the datasets. The datasets of requests tend to be confidential because they might include personal user information. Therefore, there are not many freely accessible datasets. Additionally, labeling these datasets is an expensive job that calls for specialized knowledge. The datasets of requests are randomly generated, thus may not be practical and may not display the complexity of network requests.

About the datasets challenge, to supplement and update new HTTP access data which is suitable for practical applications, we tried to combine and come up with a way to utilize other URLs datasets which are abundant, and proposed an approach that uses structural languages classification as a part of the request validator to shift the weight of the lacking and impractical request dataset to other datasets.
\newpage
\section{Tentative structure of the thesis}
\label{sec:structure}
	\newcommand\nextintro{\\[4mm]}
	\hspace{0.5cm}The structure of the thesis is divided into eight chapters, a summary of the content of each chapter is as follows.
	\nextintro
	\hyperref[chap:introduction]{\textbf{Chapter 1}} introduces issues in the field of cyber security, and clarifies the necessity of building a firewall system. Next, we present an overview of the goals, challenges, and structure of the thesis.\nextintro
	\hyperref[chap:background]{\textbf{Chapter 2}} introduces the background knowledge of this thesis, including information about Web Application Firewalls, Machine Learning Models, HTTP requests, Natural Language Processing, and Deep Neural Networks.\nextintro
	\hyperref[chap:literaturereview]{\textbf{Chapter 3}} mentions some related studies on the use of machine learning techniques to detect malicious requests, their strengths and weaknesses, and evaluate an appropriate approach for this thesis.\nextintro
	\hyperref[chap:proposed_approaches]{\textbf{Chapter 4}} displays the problems as well as the malicious request validator's input and output. Then we offer the design and architecture of the problem's solutions.\nextintro
	\hyperref[chap:implementation]{\textbf{Chapter 5}} describes the implementation steps of the systems including system frameworks.\nextintro
	\hyperref[chap:dataset]{\textbf{Chapter 6}} describes the datasets which we use to train and evaluate the Logistic Regression module and CNN categorize module, with the problems of datasets and pre-processing details.\nextintro 
	\hyperref[chap:experiments]{\textbf{Chapter 7}} discusses the division of the data set before training, assessment techniques, and experimental results. Compare the outcomes of the experiments we suggest to the reference experiments from relevant works.\nextintro
	\hyperref[chap:conclusion]{\textbf{Chapter 8}} summarizes the results for the thesis. Finally, we want to present future improvements.